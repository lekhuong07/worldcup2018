---
title: "World Cup 2018 group stage stimulation"
author: "Khuong Le"
date: "23/2/2018"
output: html_document
---

This is a project for prediction from group stage to Round 16, quarterfinals, semifinals final and runner-up. This specific Rmarkdown is for running the group stage to give different results for data to predict which teams will advace to next round. The result is on knockout_phase.Rmd. 

Load different packages that will use in this model:

```{r}
pkg_list = c("ggplot2", "stringr", "rvest", "tidyr", "dplyr", "gsubfn")
mia_pkgs = pkg_list[!(pkg_list %in% installed.packages()[,"Package"])]
if(length(mia_pkgs) > 0) install.packages(mia_pkgs)
loaded_pkgs = lapply(pkg_list, require, character.only=TRUE)
```

Using data from wikipedia from Worldcup 1998, 2002, 2006, 2010, 2014 mainly from wikipedia.

Wiki from World Cup history
```{r}
world_data = read.csv("worldcup_data.csv")
#near10wc   = read.csv("WC1998_2018.csv")
```


Function to find top two team that will advance to next ground, this function will compare Avg_GS, Avg_Gc, Pos, Avg_Pts. 
```{r}
result = vector(mode = "numeric", length = 4)
goals = function(name1, avggs1, avggc1, pot1, name2, avggs2, avggc2, pot2){
  avg1   = abs(floor((abs(avggs1) + abs(avggc2))/2))
  avg2   = abs(floor((abs(avggs2) + abs(avggc1))/2))
  if(abs(pot1 - pot2) == 1){
      score1 = abs(round(runif(1, avg1-1, avg1+1))) + rand_goals(pot1, pot2)
      score2 = abs(round(runif(1, avg2-1, avg2+1))) + rand_goals(pot1, pot2)
  }
  else if(abs(pot1 - pot2) == 2){
    if(pot1 < pot2){
      score1 = abs(round(runif(1, avg1-1, avg1+1))) + rand_goals(pot1, pot2)
      score2 = abs(round(runif(1, avg2-1, avg2+1)))   
     }
     else if(pot1 > pot2){
      score1 = abs(round(runif(1, avg1-1, avg1+1))) 
      score2 = abs(round(runif(1, avg2-1, avg2+1))) + rand_goals(pot1, pot2)
     }
  }
  else if(abs(pot1 - pot2) == 3){
    if(pot1 < pot2){
      score1 = abs(round(runif(1, avg1-1, avg1+1))) + rand_goals(pot1, pot2)
      score2 = abs(round(runif(1, avg2-1, avg2+1)))   
     }
     else if(pot1 > pot2){
      score1 = abs(round(runif(1, avg1-1, avg1+1))) 
      score2 = abs(round(runif(1, avg2-1, avg2+1))) + rand_goals(pot1, pot2)
     }
  }
  result[1] = name1
  result[2] = score1
  result[3] = name2
  result[4] = score2
  return(result)
}
#goals("KSA", 3, 2, "URU", 2, 1)
```

Random adding goals!
```{r}
rand_goals= function(pot1, pot2){
  if(abs(pot1 - pot2) == 3){
    rbinom(1,3,0.7)
  }
  else if(abs(pot1 - pot2) == 2){
    rbinom(1,2,0.7)
  }
  else if(abs(pot1 - pot2) == 1){
    rbinom(1,2,0.3)
  }
}

rand_goals(1,2)
```

Group A: (notes: Russia in the current ranking is seed 3 but since it's the home for this world cup so they will gain higher seed because they will have home advantage. Then it leads to Uruguay becomes leads 1. )
```{r}
RSA = "Russia"
RSA_pts = 0
KSA = "Saudi Arabia"
KSA_pts = 0
URU = "Uruguay"
URU_pts = 0
EGY = "Egypt"
EGY_pts = 0

for(i in 1:nrow(world_data)){
       if(world_data$Team[i] == RSA){ rsa1 = i }
  else if(world_data$Team[i] == KSA){ ksa1 = i }
  else if(world_data$Team[i] == URU){ uru1 = i }
  else if(world_data$Team[i] == EGY){ egy1 = i }
}

# Find goals that each team will have in this group stage with goal score = gs, goal concede = gc
RSA_gs = 0
RSA_gc = 0
KSA_gs = 0
KSA_gc = 0
EGY_gs = 0
EGY_gc = 0
URU_gs = 0
URU_gc = 0

```


```{r}
#1st match 
resultA1  = goals(RSA, world_data$Avg_GS[rsa1], world_data$Avg_GC[rsa1], world_data$Pot2018[rsa1], KSA, world_data$Avg_GS[ksa1], world_data$Avg_GC[ksa1], world_data$Pot2018[ksa1])
RSA_gs    = RSA_gs + as.numeric(resultA1[2])
RSA_gc    = RSA_gc + as.numeric(resultA1[4])
KSA_gs    = KSA_gs + as.numeric(resultA1[4])
KSA_gc    = KSA_gc + as.numeric(resultA1[2])

#2nd match
resultA2  = goals(EGY, world_data$Avg_GS[egy1], world_data$Avg_GC[egy1], world_data$Pot2018[egy1], URU, world_data$Avg_GS[uru1], world_data$Avg_GC[uru1], world_data$Pot2018[uru1])
EGY_gs    = EGY_gs + as.numeric(resultA2[2])
EGY_gc    = EGY_gc + as.numeric(resultA2[4])
URU_gs    = URU_gs + as.numeric(resultA2[4])
URU_gc    = URU_gc + as.numeric(resultA2[2])

#3rd match
resultA3  = goals(RSA, world_data$Avg_GS[rsa1], world_data$Avg_GC[rsa1], world_data$Pot2018[rsa1], EGY, world_data$Avg_GS[egy1], world_data$Avg_GC[egy1], world_data$Pot2018[egy1])
RSA_gs    = RSA_gs + as.numeric(resultA3[2])
RSA_gc    = RSA_gc + as.numeric(resultA3[4])
EGY_gs    = EGY_gs + as.numeric(resultA3[4])
EGY_gc    = EGY_gc + as.numeric(resultA3[2])

#4th match
resultA4  = goals(URU, world_data$Avg_GS[uru1], world_data$Avg_GC[uru1], world_data$Pot2018[uru1], KSA, world_data$Avg_GS[ksa1], world_data$Avg_GC[ksa1], world_data$Pot2018[ksa1])
URU_gs    = URU_gs + as.numeric(resultA4[2])
URU_gc    = URU_gc + as.numeric(resultA4[4])
KSA_gs    = KSA_gs + as.numeric(resultA4[4])
KSA_gc    = KSA_gc + as.numeric(resultA4[2])

#5th match
resultA5  = goals(URU, world_data$Avg_GS[uru1], world_data$Avg_GC[uru1], world_data$Pot2018[uru1], RSA, world_data$Avg_GS[rsa1], world_data$Avg_GC[rsa1], world_data$Pot2018[rsa1])
URU_gs    = URU_gs + as.numeric(resultA5[2])
URU_gc    = URU_gc + as.numeric(resultA5[4])
RSA_gs    = RSA_gs + as.numeric(resultA5[4])
RSA_gc    = RSA_gc + as.numeric(resultA5[2])

#6th match
resultA6  = goals(KSA, world_data$Avg_GS[ksa1], world_data$Avg_GC[ksa1], world_data$Pot2018[ksa1], EGY, world_data$Avg_GS[egy1], world_data$Avg_GC[egy1], world_data$Pot2018[egy1])
KSA_gs    = KSA_gs + as.numeric(resultA6[2])
KSA_gc    = KSA_gc + as.numeric(resultA6[4])
EGY_gs    = EGY_gs + as.numeric(resultA6[4])
EGY_gc    = EGY_gc + as.numeric(resultA6[2])

resA   = data.frame (resultA1, resultA2, resultA3, resultA4, resultA5, resultA6)
resA
```

Calculate points each team earns.
```{r}
if(resultA1[2] > resultA1[4]) {  RSA_pts = RSA_pts + 3 }
if(resultA1[2] < resultA1[4]) {  KSA_pts = KSA_pts + 3 }
if(resultA1[2] == resultA1[4]){
  RSA_pts = RSA_pts + 1
  KSA_pts = KSA_pts + 1
}
if(resultA2[2] > resultA2[4]) { EGY_pts = EGY_pts + 3 }
if(resultA2[2] < resultA2[4]) { URU_pts = URU_pts + 3 }
if(resultA2[2] == resultA2[4]){
  EGY_pts = EGY_pts + 1
  URU_pts = URU_pts + 1
}
if(resultA3[2] > resultA3[4]) {  RSA_pts = RSA_pts + 3 }
if(resultA3[2] < resultA3[4]) {  EGY_pts = EGY_pts + 3 }
if(resultA3[2] == resultA3[4]){
  RSA_pts = RSA_pts + 1
  EGY_pts = EGY_pts + 1
}
if(resultA4[2] > resultA4[4]) {  URU_pts = URU_pts + 3 }
if(resultA4[2] < resultA4[4]) {  KSA_pts = KSA_pts + 3 }
if(resultA4[2] == resultA4[4]){
  URU_pts = URU_pts + 1
  KSA_pts = KSA_pts + 1
}
if(resultA5[2] > resultA5[4]) {  URU_pts = URU_pts + 3 }
if(resultA5[2] < resultA5[4]) {  RSA_pts = RSA_pts + 3 }
if(resultA5[2] == resultA5[4]){
  URU_pts = URU_pts + 1
  RSA_pts = RSA_pts + 1
}
if(resultA6[2] > resultA6[4]) {  KSA_pts = KSA_pts + 3 }
if(resultA6[2] < resultA6[4]) {  EGY_pts = EGY_pts + 3 }
if(resultA6[2] == resultA6[4]){
  KSA_pts = KSA_pts + 1
  EGY_pts = EGY_pts + 1
}

RSA_di = RSA_gs - RSA_gc
KSA_di = KSA_gs - KSA_gc
EGY_di = EGY_gs - EGY_gc
URU_di = URU_gs - URU_gc

RSA_goal = c(RSA_gs, RSA_gc, RSA_di)
KSA_goal = c(KSA_gs, KSA_gc, KSA_di)
EGY_goal = c(EGY_gs, EGY_gc, EGY_di)
URU_goal = c(URU_gs, URU_gc, URU_di)
```

Setup the position
```{r}
teamA     = c(RSA, URU, EGY, KSA)
teamA_pts = c(RSA_pts, URU_pts, EGY_pts, KSA_pts)
teamA_gs  = c(RSA_gs, URU_gs, EGY_gs, KSA_gs)
teamA_gc  = c(RSA_gc, URU_gc, EGY_gc, KSA_gc)
teamA_di  = c(RSA_di, URU_di, EGY_di, KSA_di)
groupA    = data.frame (teamA, teamA_gs, teamA_gc, teamA_di, teamA_pts)

finalA = groupA[order(groupA$teamA_pts, decreasing = TRUE),]
rownames(finalA)[1] <- "1st"
rownames(finalA)[2] <- "2nd"
rownames(finalA)[3] <- "3rd"
rownames(finalA)[4] <- "4th"
finalA
```

These two teams qualify for the next round
```{r}
qualA1 = finalA[1,]
qualA2 = finalA[2,]
qualA1
qualA2
```


Group B:
```{r}
POR = "Portugal"
POR_pts = 0
ESP = "Spain"
ESP_pts = 0
MAR = "Morocco"	
MAR_pts = 0
IRI = "Iran" 	
IRI_pts = 0

for(i in 1:nrow(world_data)){
       if(world_data$Team[i] == POR){ por1 = i }
  else if(world_data$Team[i] == ESP){ esp1 = i }
  else if(world_data$Team[i] == MAR){ mar1 = i }
  else if(world_data$Team[i] == IRI){ iri1 = i }
}
# Find goals that each team will have in this group stage with goal score = gs, goal concede = gc
POR_gs = 0
POR_gc = 0
ESP_gs = 0
ESP_gc = 0
MAR_gs = 0
MAR_gc = 0
IRI_gs = 0
IRI_gc = 0

```

```{r}
#1st match
resultB1  = goals(MAR, world_data$Avg_GS[mar1], world_data$Avg_GC[mar1], world_data$Pot2018[mar1], IRI, world_data$Avg_GS[iri1], world_data$Avg_GC[iri1],  world_data$Pot2018[iri1])
MAR_gs    = MAR_gs + as.numeric(resultB1[2])
MAR_gc    = MAR_gc + as.numeric(resultB1[4])
IRI_gs    = IRI_gs + as.numeric(resultB1[4])
IRI_gc    = IRI_gc + as.numeric(resultB1[2])
#2nd match
resultB2  = goals(POR, world_data$Avg_GS[por1], world_data$Avg_GC[por1],  world_data$Pot2018[por1], ESP, world_data$Avg_GS[esp1], world_data$Avg_GC[esp1],  world_data$Pot2018[esp1])
POR_gs    = POR_gs + as.numeric(resultB2[2])
POR_gc    = POR_gc + as.numeric(resultB2[4])
ESP_gs    = ESP_gs + as.numeric(resultB2[4])
ESP_gc    = ESP_gc + as.numeric(resultB2[2])
#3rd match
resultB3  = goals(POR, world_data$Avg_GS[por1], world_data$Avg_GC[por1],  world_data$Pot2018[por1], MAR, world_data$Avg_GS[mar1], world_data$Avg_GC[mar1],  world_data$Pot2018[mar1])
POR_gs    = POR_gs + as.numeric(resultB3[2])
POR_gc    = POR_gc + as.numeric(resultB3[4])
MAR_gs    = MAR_gs + as.numeric(resultB3[4])
MAR_gc    = MAR_gc + as.numeric(resultB3[2])
#4th match
resultB4  = goals(IRI, world_data$Avg_GS[iri1], world_data$Avg_GC[iri1],  world_data$Pot2018[iri1], ESP, world_data$Avg_GS[esp1], world_data$Avg_GC[esp1],  world_data$Pot2018[esp1])
IRI_gs    = IRI_gs + as.numeric(resultB4[2])
IRI_gc    = IRI_gc + as.numeric(resultB4[4])
ESP_gs    = ESP_gs + as.numeric(resultB4[4])
ESP_gc    = ESP_gc + as.numeric(resultB4[2])
#5th match
resultB5  = goals(ESP, world_data$Avg_GS[esp1], world_data$Avg_GC[esp1],  world_data$Pot2018[esp1], MAR, world_data$Avg_GS[mar1], world_data$Avg_GC[mar1],  world_data$Pot2018[mar1])
ESP_gs    = ESP_gs + as.numeric(resultB5[2])
ESP_gc    = ESP_gc + as.numeric(resultB5[4])
MAR_gs    = MAR_gs + as.numeric(resultB5[4])
MAR_gc    = MAR_gc + as.numeric(resultB5[2])
#6th match
resultB6  = goals(IRI, world_data$Avg_GS[iri1], world_data$Avg_GC[iri1],  world_data$Pot2018[iri1], POR, world_data$Avg_GS[por1], world_data$Avg_GC[por1],  world_data$Pot2018[por1])
IRI_gs    = IRI_gs + as.numeric(resultB6[2])
IRI_gc    = IRI_gc + as.numeric(resultB6[4])
POR_gs    = POR_gs + as.numeric(resultB6[4])
POR_gc    = POR_gc + as.numeric(resultB6[2])

resB   = data.frame (resultB1, resultB2, resultB3, resultB4, resultB5, resultB6)
resB
```

Calculate the points
```{r}
if(resultB1[2] > resultB1[4]) {  MAR_pts = MAR_pts + 3 }
if(resultB1[2] < resultB1[4]) {  IRI_pts = IRI_pts + 3 }
if(resultB1[2] == resultB1[4]){
  MAR_pts = MAR_pts + 1
  IRI_pts = IRI_pts + 1
}
if(resultB2[2] > resultB2[4]) {  POR_pts = POR_pts + 3 }
if(resultB2[2] < resultB2[4]) {  ESP_pts = ESP_pts + 3 }
if(resultB2[2] == resultB2[4]){
  POR_pts = POR_pts + 1
  ESP_pts = ESP_pts + 1
}
if(resultB3[2] > resultB3[4]) {  POR_pts = POR_pts + 3 }
if(resultB3[2] < resultB3[4]) {  MAR_pts = MAR_pts + 3 }
if(resultB3[2] == resultB3[4]){
  POR_pts = POR_pts + 1
  MAR_pts = MAR_pts + 1
}
if(resultB4[2] > resultB4[4]) {  IRI_pts = IRI_pts + 3 }
if(resultB4[2] < resultB4[4]) {  ESP_pts = ESP_pts + 3 }
if(resultB4[2] == resultB4[4]){
  ESP_pts = ESP_pts + 1
  IRI_pts = IRI_pts + 1
}
if(resultB5[2] > resultB5[4]) {  ESP_pts = ESP_pts + 3 }
if(resultB5[2] < resultB5[4]) {  MAR_pts = MAR_pts + 3 }
if(resultB5[2] == resultB5[4]){
  MAR_pts = MAR_pts + 1
  ESP_pts = ESP_pts + 1
}
if(resultB6[2] > resultB6[4]) {  IRI_pts = IRI_pts + 3 }
if(resultB6[2] < resultB6[4]) {  POR_pts = POR_pts + 3 }
if(resultB6[2] == resultB6[4]){
  POR_pts = POR_pts + 1
  IRI_pts = IRI_pts + 1
}
POR_di = POR_gs - POR_gc
ESP_di = ESP_gs - ESP_gc
MAR_di = MAR_gs - MAR_gc
IRI_di = IRI_gs - IRI_gc

POR_goal = c(POR_gs, POR_gc, POR_di)
ESP_goal = c(ESP_gs, ESP_gc, ESP_di)
MAR_goal = c(MAR_gs, MAR_gc, MAR_di)
IRI_goal = c(IRI_gs, IRI_gc, IRI_di)
```

Set up to see the result table in group B
```{r}
#if 2 teams have the same result in everything, determine the higher team by fifa ranking updated in May 17th

teamB     = c(POR, ESP, MAR, IRI)
teamB_pts = c(POR_pts, ESP_pts, MAR_pts, IRI_pts)
teamB_gs  = c(POR_gs, ESP_gs, MAR_gs, IRI_gs)
teamB_gc  = c(POR_gc, ESP_gc, MAR_gc, IRI_gc)
teamB_di  = c(POR_di, ESP_di, MAR_di, IRI_di)
groupB    = data.frame (teamB, teamB_gs, teamB_gc, teamB_di, teamB_pts)

finalB = groupB[order(groupB$teamB_pts, decreasing = TRUE),]
rownames(finalB)[1] <- "1st"
rownames(finalB)[2] <- "2nd"
rownames(finalB)[3] <- "3rd"
rownames(finalB)[4] <- "4th"

finalB
```

These two teams qualify for the next round
```{r}
qualB1 = finalB[1,]
qualB2 = finalB[2,]
qualB1
qualB2
```

Group C:
```{r}
FRA = "France"
FRA_pts = 0
AUS = "Australia"
AUS_pts = 0
PER = "Peru"	
PER_pts = 0
DAN = "Denmark"	
DAN_pts = 0
for(i in 1:nrow(world_data)){
       if(world_data$Team[i] == FRA){ fra1 = i }
  else if(world_data$Team[i] == AUS){ aus1 = i }
  else if(world_data$Team[i] == PER){ per1 = i }
  else if(world_data$Team[i] == DAN){ dan1 = i }
}
# Find goals that each team will have in this group_stage with goal score = gs, goal concede = gc
FRA_gs = 0
FRA_gc = 0
AUS_gs = 0
AUS_gc = 0
PER_gs = 0
PER_gc = 0
DAN_gs = 0
DAN_gc = 0

```

```{r}
#1st match
resultC1  = goals(FRA, world_data$Avg_GS[fra1], world_data$Avg_GC[fra1], world_data$Pot2018[fra1], AUS, world_data$Avg_GS[aus1], world_data$Avg_GC[aus1], world_data$Pot2018[aus1])
FRA_gs    = FRA_gs + as.numeric(resultC1[2])
FRA_gc    = FRA_gc + as.numeric(resultC1[4])
AUS_gs    = AUS_gs + as.numeric(resultC1[4])
AUS_gc    = AUS_gc + as.numeric(resultC1[2])

if(resultC1[2] > resultC1[4]) {  FRA_pts = FRA_pts + 3 }
if(resultC1[2] < resultC1[4]) {  AUS_pts = AUS_pts + 3 }
if(resultC1[2] == resultC1[4]){
  FRA_pts = FRA_pts + 1
  AUS_pts = AUS_pts + 1
}
#2nd match
resultC2  = goals(PER, world_data$Avg_GS[per1], world_data$Avg_GC[per1], world_data$Pot2018[per1], DAN, world_data$Avg_GS[dan1], world_data$Avg_GC[dan1], world_data$Pot2018[dan1])
PER_gs    = PER_gs + as.numeric(resultC2[2])
PER_gc    = PER_gc + as.numeric(resultC2[4])
DAN_gs    = DAN_gs + as.numeric(resultC2[4])
DAN_gc    = DAN_gc + as.numeric(resultC2[2])

if(resultC2[2] > resultC2[4]) {  PER_pts = PER_pts + 3 }
if(resultC2[2] < resultC2[4]) {  DAN_pts = DAN_pts + 3 }
if(resultC2[2] == resultC2[4]){
  PER_pts = PER_pts + 1
  DAN_pts = DAN_pts + 1
}
#3rd match
resultC3  = goals(DAN, world_data$Avg_GS[dan1], world_data$Avg_GC[dan1], world_data$Pot2018[dan1], AUS, world_data$Avg_GS[aus1], world_data$Avg_GC[aus1], world_data$Pot2018[aus1])
DAN_gs    = DAN_gs + as.numeric(resultC3[2])
DAN_gc    = DAN_gc + as.numeric(resultC3[4])
AUS_gs    = AUS_gs + as.numeric(resultC3[4])
AUS_gc    = AUS_gc + as.numeric(resultC3[2])
if(resultC3[2] > resultC3[4]) {  DAN_pts = DAN_pts + 3 }
if(resultC3[2] < resultC3[4]) {  AUS_pts = AUS_pts + 3 }
if(resultC3[2] == resultC3[4]){
  DAN_pts = DAN_pts + 1
  AUS_pts = AUS_pts + 1
}
#4th match
resultC4  = goals(FRA, world_data$Avg_GS[fra1], world_data$Avg_GC[fra1], world_data$Pot2018[fra1], PER, world_data$Avg_GS[per1], world_data$Avg_GC[per1], world_data$Pot2018[per1])
FRA_gs    = FRA_gs + as.numeric(resultC4[2])
FRA_gc    = FRA_gc + as.numeric(resultC4[4])
PER_gs    = PER_gs + as.numeric(resultC4[4])
PER_gc    = PER_gc + as.numeric(resultC4[2])
if(resultC4[2] > resultC4[4]) {  FRA_pts = FRA_pts + 3 }
if(resultC4[2] < resultC4[4]) {  PER_pts = PER_pts + 3 }
if(resultC4[2] == resultC4[4]){
  FRA_pts = FRA_pts + 1
  PER_pts = PER_pts + 1
}
#5th match
resultC5  = goals(DAN, world_data$Avg_GS[dan1], world_data$Avg_GC[dan1], world_data$Pot2018[dan1], FRA, world_data$Avg_GS[fra1], world_data$Avg_GC[fra1], world_data$Pot2018[fra1])
DAN_gs    = DAN_gs + as.numeric(resultC5[2])
DAN_gc    = DAN_gc + as.numeric(resultC5[4])
FRA_gs    = FRA_gs + as.numeric(resultC5[4])
if(resultC5[2] > resultC5[4]) {  DAN_pts = DAN_pts + 3 }
if(resultC5[2] < resultC5[4]) {  FRA_pts = FRA_pts + 3 }
if(resultC5[2] == resultC5[4]){
  FRA_pts = FRA_pts + 1
  DAN_pts = DAN_pts + 1
}
#6th match
resultC6  = goals(AUS, world_data$Avg_GS[aus1], world_data$Avg_GC[aus1], world_data$Pot2018[aus1], PER, world_data$Avg_GS[per1], world_data$Avg_GC[per1], world_data$Pot2018[per1])
AUS_gs    = AUS_gs + as.numeric(resultC6[2])
AUS_gc    = AUS_gc + as.numeric(resultC6[4])
PER_gs    = PER_gs + as.numeric(resultC6[4])
PER_gc    = PER_gc + as.numeric(resultC6[2])
if(resultC6[2] > resultC6[4]) {  AUS_pts = AUS_pts + 3 }
if(resultC6[2] < resultC6[4]) {  PER_pts = PER_pts + 3 }
if(resultC6[2] == resultC6[4]){
  AUS_pts = AUS_pts + 1
  PER_pts = PER_pts + 1
}
FRA_di = FRA_gs - FRA_gc
AUS_di = AUS_gs - AUS_gc
PER_di = PER_gs - PER_gc
DAN_di = DAN_gs - DAN_gc

FRA_goal = c(FRA_gs, FRA_gc, FRA_di)
AUS_goal = c(AUS_gs, AUS_gc, AUS_di)
PER_goal = c(PER_gs, PER_gc, PER_di)
DAN_goal = c(DAN_gs, DAN_gc, DAN_di)

resC   = data.frame (resultC1, resultC2, resultC3, resultC4, resultC5, resultC6)
resC
```

Set up to see the result table in group B
```{r}
#if 2 teams have the same result in everything, determine the higher team by fifa ranking updated in May 17th

teamC     = c(FRA, AUS, PER, DAN)
teamC_pts = c(FRA_pts,AUS_pts, PER_pts, DAN_pts)
teamC_gs  = c(FRA_gs, AUS_gs, PER_gs, DAN_gs)
teamC_gc  = c(FRA_gc, AUS_gc, PER_gc, DAN_gc)
teamC_di  = c(FRA_di, AUS_di, PER_di, DAN_di)
groupC    = data.frame(teamC, teamC_gs, teamC_gc, teamC_di, teamC_pts)

finalC = groupC[order(groupC$teamC_pts, decreasing = TRUE),]
rownames(finalC)[1] <- "1st"
rownames(finalC)[2] <- "2nd"
rownames(finalC)[3] <- "3rd"
rownames(finalC)[4] <- "4th"

finalC
```

These two teams qualify for the next round
```{r}
qualC1 = finalC[1,]
qualC2 = finalC[2,]
qualC1
qualC2
```

Group D:
```{r}
ARG = "Argentina"
ARG_pts = 0
ICE = "Iceland"	
ICE_pts = 0
CRO = "Croatia"	
CRO_pts = 0
NGA = "Nigeria"	
NGA_pts = 0

for(i in 1:nrow(world_data)){
       if(world_data$Team[i] == ARG){ arg1 = i }
  else if(world_data$Team[i] == ICE){ ice1 = i }
  else if(world_data$Team[i] == CRO){ cro1 = i }
  else if(world_data$Team[i] == NGA){ nga1 = i }
}
# Find goals that each team will have in this group_stage with goal score = gs, goal concede = gc
ARG_gs = 0
ARG_gc = 0
ICE_gs = 0
ICE_gc = 0
CRO_gs = 0
CRO_gc = 0
NGA_gs = 0
NGA_gc = 0

```

```{r}
#1st match
resultD1  = goals(ARG, world_data$Avg_GS[arg1], world_data$Avg_GC[arg1], world_data$Pot2018[arg1], ICE, world_data$Avg_GS[ice1], world_data$Avg_GC[ice1], world_data$Pot2018[ice1])
ARG_gs    = ARG_gs + as.numeric(resultD1[2])
ARG_gc    = ARG_gc + as.numeric(resultD1[4])
ICE_gs    = ICE_gs + as.numeric(resultD1[4])
ICE_gc    = ICE_gc + as.numeric(resultD1[2])
if(resultD1[2] > resultD1[4]) {  ARG_pts = ARG_pts + 3 }
if(resultD1[2] < resultD1[4]) {  ICE_pts = ICE_pts + 3 }
if(resultD1[2] == resultD1[4]){
  ARG_pts = ARG_pts + 1
  ICE_pts = ICE_pts + 1
}
#2nd match
resultD2  = goals(CRO, world_data$Avg_GS[cro1], world_data$Avg_GC[cro1], world_data$Pot2018[cro1], NGA, world_data$Avg_GS[nga1], world_data$Avg_GC[nga1], world_data$Pot2018[nga1])
CRO_gs    = CRO_gs + as.numeric(resultD2[2])
CRO_gc    = CRO_gc + as.numeric(resultD2[4])
NGA_gs    = NGA_gs + as.numeric(resultD2[4])
NGA_gc    = NGA_gc + as.numeric(resultD2[2])

if(resultD2[2] > resultD2[4]) {  CRO_pts = CRO_pts + 3 }
if(resultD2[2] < resultD2[4]) {  NGA_pts = NGA_pts + 3 }
if(resultD2[2] == resultD2[4]){
  CRO_pts = CRO_pts + 1
  NGA_pts = NGA_pts + 1
}
#3rd match
resultD3  = goals(ARG, world_data$Avg_GS[arg1], world_data$Avg_GC[arg1], world_data$Pot2018[arg1], CRO, world_data$Avg_GS[cro1], world_data$Avg_GC[cro1], world_data$Pot2018[cro1])
ARG_gs    = ARG_gs + as.numeric(resultD3[2])
ARG_gc    = ARG_gc + as.numeric(resultD3[4])
CRO_gs    = CRO_gs + as.numeric(resultD3[4])
CRO_gc    = CRO_gc + as.numeric(resultD3[2])

if(resultD3[2] > resultD3[4]) {  ARG_pts = ARG_pts + 3 }
if(resultD3[2] < resultD3[4]) {  CRO_pts = CRO_pts + 3 }
if(resultD3[2] == resultD3[4]){
  ARG_pts = ARG_pts + 1
  CRO_pts = CRO_pts + 1
}
#4th match
resultD4  = goals(NGA, world_data$Avg_GS[nga1], world_data$Avg_GC[nga1], world_data$Pot2018[nga1], ICE, world_data$Avg_GS[ice1], world_data$Avg_GC[ice1], world_data$Pot2018[ice1])
NGA_gs    = NGA_gs + as.numeric(resultD4[2])
NGA_gc    = NGA_gc + as.numeric(resultD4[4])
ICE_gs    = ICE_gs + as.numeric(resultD4[4])
ICE_gc    = ICE_gc + as.numeric(resultD4[2])
if(resultD4[2] > resultD4[4]) {  NGA_pts = NGA_pts + 3 }
if(resultD4[2] < resultD4[4]) {  ICE_pts = ICE_pts + 3 }
if(resultD4[2] == resultD4[4]){
  NGA_pts = NGA_pts + 1
  ICE_pts = ICE_pts + 1
}
#5th match
resultD5  = goals(NGA, world_data$Avg_GS[nga1], world_data$Avg_GC[nga1], world_data$Pot2018[nga1], ARG, world_data$Avg_GS[arg1], world_data$Avg_GC[arg1], world_data$Pot2018[arg1])
NGA_gs    = NGA_gs + as.numeric(resultD5[2])
NGA_gc    = NGA_gc + as.numeric(resultD5[4])
ARG_gs    = ARG_gs + as.numeric(resultD5[4])
ARG_gc    = ARG_gc + as.numeric(resultD5[2])

if(resultD5[2] > resultD5[4]) {  NGA_pts = NGA_pts + 3 }
if(resultD5[2] < resultD5[4]) {  ARG_pts = ARG_pts + 3 }
if(resultD5[2] == resultD5[4]){
  NGA_pts = NGA_pts + 1
  ARG_pts = ARG_pts + 1
}
#6th match
resultD6  = goals(ICE, world_data$Avg_GS[ice1], world_data$Avg_GC[ice1], world_data$Pot2018[ice1], CRO, world_data$Avg_GS[cro1], world_data$Avg_GC[cro1], world_data$Pot2018[cro1])
ICE_gs    = ICE_gs + as.numeric(resultD6[2])
ICE_gc    = ICE_gc + as.numeric(resultD6[4])
CRO_gs    = CRO_gs + as.numeric(resultD6[4])
CRO_gc    = CRO_gc + as.numeric(resultD6[2])

if(resultD6[2] > resultD6[4]) {  ICE_pts = ICE_pts + 3 }
if(resultD6[2] < resultD6[4]) {  CRO_pts = CRO_pts + 3 }
if(resultD6[2] == resultD6[4]){
  ICE_pts = ICE_pts + 1
  CRO_pts = CRO_pts + 1
}
ARG_di = ARG_gs - ARG_gc
ICE_di = ICE_gs - ICE_gc
CRO_di = CRO_gs - CRO_gc
NGA_di = NGA_gs - NGA_gc

ARG_goal = c(ARG_gs, ARG_gc, ARG_di)
ICE_goal = c(ICE_gs, ICE_gc, ICE_di)
CRO_goal = c(CRO_gs, CRO_gc, CRO_di)
NGA_goal = c(NGA_gs, NGA_gc, NGA_di)

resD   = data.frame (resultD1, resultD2, resultD3, resultD4, resultD5, resultD6)
resD
```

Set up to see the result table in group D (notes: Iceland is still a mystery in this group but they are lucky that they get seed 3 so they will have higher chance to advance to next round than Nigeria .)
```{r}
#if 2 teams have the same result in everything, determine the higher team by fifa ranking updated in May 17th

teamD     = c(ARG, ICE, CRO, NGA)
teamD_pts = c(ARG_pts,ICE_pts, CRO_pts, NGA_pts)
teamD_gs  = c(ARG_gs, ICE_gs, CRO_gs, NGA_gs)
teamD_gc  = c(ARG_gc, ICE_gc, CRO_gc, NGA_gc)
teamD_di  = c(ARG_di, ICE_di, CRO_di, NGA_di)
groupD    = data.frame(teamD, teamD_gs, teamD_gc, teamD_di, teamD_pts)

finalD = groupD[order(groupD$teamD_pts, decreasing = TRUE),]
rownames(finalD)[1] <- "1st"
rownames(finalD)[2] <- "2nd"
rownames(finalD)[3] <- "3rd"
rownames(finalD)[4] <- "4th"

finalD
```

These teams qualify for groupD
```{r}
qualD1 = finalD[1,]
qualD2 = finalD[2,]
qualD1
qualD2
```

Groupd E:
```{r}
BRA = "Brazil"
BRA_pts = 0
SWI = "Switzerland"
SWI_pts = 0
CRI = "Costa Rica"
CRI_pts = 0
SRB = "Serbia"
SRB_pts = 0

for(i in 1:nrow(world_data)){
       if(world_data$Team[i] == BRA){ bra1 = i }
  else if(world_data$Team[i] == SWI){ swi1 = i }
  else if(world_data$Team[i] == CRI){ cri1 = i }
  else if(world_data$Team[i] == SRB){ srb1 = i }
}
# Find goals that each team will have in this group_stage with goal score = gs, goal concede = gc
BRA_gs = 0
BRA_gc = 0
SWI_gs = 0
SWI_gc = 0
CRI_gs = 0
CRI_gc = 0
SRB_gs = 0
SRB_gc = 0

```

```{r}
#1st match
resultE1  = goals(CRI, world_data$Avg_GS[cri1], world_data$Avg_GC[cri1], world_data$Pot2018[cri1], SRB, world_data$Avg_GS[srb1], world_data$Avg_GC[srb1], world_data$Pot2018[srb1])
CRI_gs    = CRI_gs + as.numeric(resultE1[2])
CRI_gc    = CRI_gc + as.numeric(resultE1[4])
SRB_gs    = SRB_gs + as.numeric(resultE1[4])
SRB_gc    = SRB_gc + as.numeric(resultE1[2])
if(resultE1[2] > resultE1[4]) {  CRI_pts = CRI_pts + 3 }
if(resultE1[2] < resultE1[4]) {  SRB_pts = SRB_pts + 3 }
if(resultE1[2] == resultE1[4]){
  CRI_pts = CRI_pts + 1
  SRB_pts = SRB_pts + 1
}
#2nd match
resultE2  = goals(BRA, world_data$Avg_GS[bra1], world_data$Avg_GC[bra1], world_data$Pot2018[bra1], SWI, world_data$Avg_GS[swi1], world_data$Avg_GC[swi1], world_data$Pot2018[swi1])
BRA_gs    = BRA_gs + as.numeric(resultE2[2])
BRA_gc    = BRA_gc + as.numeric(resultE2[4])
SWI_gs    = SWI_gs + as.numeric(resultE2[4])
SWI_gc    = SWI_gc + as.numeric(resultE2[2])

if(resultE2[2] > resultE2[4]) {  BRA_pts = BRA_pts + 3 }
if(resultE2[2] < resultE2[4]) {  SWI_pts = SWI_pts + 3 }
if(resultE2[2] == resultE2[4]){
  BRA_pts = BRA_pts + 1
  SWI_pts = SWI_pts + 1
}
#3rd match
resultE3  = goals(BRA, world_data$Avg_GS[bra1], world_data$Avg_GC[bra1], world_data$Pot2018[bra1], CRI, world_data$Avg_GS[cri1], world_data$Avg_GC[cri1], world_data$Pot2018[cri1])
BRA_gs    = BRA_gs + as.numeric(resultE3[2])
BRA_gc    = BRA_gc + as.numeric(resultE3[4])
CRI_gs    = CRI_gs + as.numeric(resultE3[4])
CRI_gc    = CRI_gc + as.numeric(resultE3[2])

if(resultE3[2] > resultE3[4]) {  BRA_pts = BRA_pts + 3 }
if(resultE3[2] < resultE3[4]) {  CRI_pts = CRI_pts + 3 }
if(resultE3[2] == resultE3[4]){
  BRA_pts = BRA_pts + 1
  CRI_pts = CRI_pts + 1
}
#4th match
resultE4  = goals(SRB, world_data$Avg_GS[srb1], world_data$Avg_GC[srb1], world_data$Pot2018[srb1], SWI, world_data$Avg_GS[swi1], world_data$Avg_GC[swi1], world_data$Pot2018[swi1])
SRB_gs    = SRB_gs + as.numeric(resultE4[2])
SRB_gc    = SRB_gc + as.numeric(resultE4[4])
SWI_gs    = SWI_gs + as.numeric(resultE4[4])
SWI_gc    = SWI_gc + as.numeric(resultE4[2])

if(resultE4[2] > resultE4[4]) {  SRB_pts = SRB_pts + 3 }
if(resultE4[2] < resultE4[4]) {  SWI_pts = SWI_pts + 3 }
if(resultE4[2] == resultE4[4]){
  SRB_pts = SRB_pts + 1
  SWI_pts = SWI_pts + 1
}
#5th match
resultE5  = goals(SRB, world_data$Avg_GS[srb1], world_data$Avg_GC[srb1], world_data$Pot2018[srb1], BRA, world_data$Avg_GS[bra1], world_data$Avg_GC[bra1], world_data$Pot2018[bra1])
SRB_gs    = SRB_gs + as.numeric(resultE5[2])
SRB_gc    = SRB_gc + as.numeric(resultE5[4])
BRA_gs    = BRA_gs + as.numeric(resultE5[4])
BRA_gc    = BRA_gc + as.numeric(resultE5[2])

if(resultE5[2] > resultE5[4]) {  SRB_pts = SRB_pts + 3 }
if(resultE5[2] < resultE5[4]) {  BRA_pts = BRA_pts + 3 }
if(resultE5[2] == resultE5[4]){
  SRB_pts = SRB_pts + 1
  BRA_pts = BRA_pts + 1
}
#6th match
resultE6  = goals(SWI, world_data$Avg_GS[swi1], world_data$Avg_GC[swi1], world_data$Pot2018[swi1], CRI, world_data$Avg_GS[cri1], world_data$Avg_GC[cri1], world_data$Pot2018[cri1])
SWI_gs    = SWI_gs + as.numeric(resultE6[2])
SWI_gc    = SWI_gc + as.numeric(resultE6[4])
CRI_gs    = CRI_gs + as.numeric(resultE6[4])
CRI_gc    = CRI_gc + as.numeric(resultE6[2])

if(resultE6[2] > resultE6[4]) {  SWI_pts = SWI_pts + 3 }
if(resultE6[2] < resultE6[4]) {  CRI_pts = CRI_pts + 3 }
if(resultE6[2] == resultE6[4]){
  SWI_pts = SWI_pts + 1
  CRI_pts = CRI_pts + 1
}
BRA_di = BRA_gs - BRA_gc
SWI_di = SWI_gs - SWI_gc
CRI_di = CRI_gs - CRI_gc
SRB_di = SRB_gs - SRB_gc

BRA_goal = c(BRA_gs, BRA_gc, BRA_di)
SWI_goal = c(SWI_gs, SWI_gc, SWI_di)
CRI_goal = c(CRI_gs, CRI_gc, CRI_di)
SRB_goal = c(SRB_gs, SRB_gc, SRB_di)

resE   = data.frame(resultE1, resultE2, resultE3, resultE4, resultE5, resultE6)
resE
```

Set up to see the result table in group D
```{r}
#if 2 teams have the same result in everything, determine the higher team by fifa ranking updated in May 17th

teamE     = c(BRA, SWI, CRI, SRB)
teamE_pts = c(BRA_pts, SWI_pts, CRI_pts, SRB_pts)
teamE_gs  = c(BRA_gs, SWI_gs, CRI_gs, SRB_gs)
teamE_gc  = c(BRA_gc, SWI_gc, CRI_gc, SRB_gc)
teamE_di  = c(BRA_di, SWI_di, CRI_di, SRB_di)
groupE    = data.frame(teamE, teamE_gs, teamE_gc, teamE_di, teamE_pts)

finalE = groupE[order(groupE$teamE_pts, decreasing = TRUE),]
rownames(finalE)[1] <- "1st"
rownames(finalE)[2] <- "2nd"
rownames(finalE)[3] <- "3rd"
rownames(finalE)[4] <- "4th"

finalE
```

Teams that qualify to knock out stage
```{r}
qualE1 = finalE[1,]
qualE2 = finalE[2,]
qualE1
qualE2
```

Group F:
```{r}
GER = "Germany"
GER_pts = 0
MEX = "Mexico"
MEX_pts = 0
SWE = "Sweden"
SWE_pts = 0
KOR = "South Korea"
KOR_pts = 0

for(i in 1:nrow(world_data)){
       if(world_data$Team[i] == GER){ ger1 = i }
  else if(world_data$Team[i] == MEX){ mex1 = i }
  else if(world_data$Team[i] == SWE){ swe1 = i }
  else if(world_data$Team[i] == KOR){ kor1 = i }
}
GER_gs = 0
GER_gc = 0
SWE_gs = 0
SWE_gc = 0
KOR_gs = 0
KOR_gc = 0
MEX_gs = 0
MEX_gc = 0
```

```{r}
#1st match
resultF1  = goals(GER, world_data$Avg_GS[ger1], world_data$Avg_GC[ger1], world_data$Pot2018[ger1], MEX, world_data$Avg_GS[mex1], world_data$Avg_GC[mex1], world_data$Pot2018[mex1])
GER_gs    = GER_gs + as.numeric(resultF1[2])
GER_gc    = GER_gc + as.numeric(resultF1[4])
MEX_gs    = MEX_gs + as.numeric(resultF1[4])
MEX_gc    = GER_gc + as.numeric(resultF1[2])
if(resultF1[2] > resultF1[4]) {  GER_pts = GER_pts + 3 }
if(resultF1[2] < resultF1[4]) {  MEX_pts = MEX_pts + 3 }
if(resultF1[2] == resultF1[4]){
  GER_pts = GER_pts + 1
  MEX_pts = MEX_pts + 1
}
#2nd match
resultF2  = goals(SWE, world_data$Avg_GS[swe1], world_data$Avg_GC[swe1], world_data$Pot2018[swe1], KOR, world_data$Avg_GS[kor1], world_data$Avg_GC[kor1], world_data$Pot2018[kor1])
SWE_gs    = SWE_gs + as.numeric(resultF2[2])
SWE_gc    = SWE_gc + as.numeric(resultF2[4])
KOR_gs    = KOR_gs + as.numeric(resultF2[4])
KOR_gc    = KOR_gc + as.numeric(resultF2[2])
if(resultF2[2] > resultF2[4]) {  SWE_pts = SWE_pts + 3 }
if(resultF2[2] < resultF2[4]) {  KOR_pts = KOR_pts + 3 }
if(resultF2[2] == resultF2[4]){
  SWE_pts = SWE_pts + 1
  KOR_pts = KOR_pts + 1
}
#3rd match
resultF3  = goals(KOR, world_data$Avg_GS[kor1], world_data$Avg_GC[kor1], world_data$Pot2018[kor1], MEX, world_data$Avg_GS[mex1], world_data$Avg_GC[mex1], world_data$Pot2018[mex1])
KOR_gs    = KOR_gs + as.numeric(resultF3[2])
KOR_gc    = KOR_gc + as.numeric(resultF3[4])
MEX_gs    = MEX_gs + as.numeric(resultF3[4])
MEX_gc    = MEX_gc + as.numeric(resultF3[2])
if(resultF3[2] > resultF3[4]) {  KOR_pts = KOR_pts + 3 }
if(resultF3[2] < resultF3[4]) {  MEX_pts = MEX_pts + 3 }
if(resultF3[2] == resultF3[4]){
  KOR_pts = KOR_pts + 1
  MEX_pts = MEX_pts + 1
}
#4th match
resultF4  = goals(GER, world_data$Avg_GS[ger1], world_data$Avg_GC[ger1], world_data$Pot2018[ger1], SWE, world_data$Avg_GS[swe1], world_data$Avg_GC[swe1], world_data$Pot2018[swe1])
GER_gs    = GER_gs + as.numeric(resultF4[2])
GER_gc    = GER_gc + as.numeric(resultF4[4])
SWE_gs    = SWE_gs + as.numeric(resultF4[4])
SWE_gc    = SWE_gc + as.numeric(resultF4[2])
if(resultF4[2] > resultF4[4]) {  GER_pts = GER_pts + 3 }
if(resultF4[2] < resultF4[4]) {  SWE_pts = SWE_pts + 3 }
if(resultF4[2] == resultF4[4]){
  GER_pts = GER_pts + 1
  SWE_pts = SWE_pts + 1
}
#5th match
resultF5  = goals(KOR, world_data$Avg_GS[kor1], world_data$Avg_GC[kor1], world_data$Pot2018[kor1], GER, world_data$Avg_GS[ger1], world_data$Avg_GC[ger1], world_data$Pot2018[ger1])
KOR_gs    = KOR_gs + as.numeric(resultF5[2])
KOR_gc    = KOR_gc + as.numeric(resultF5[4])
GER_gs    = GER_gs + as.numeric(resultF5[4])
GER_gc    = GER_gc + as.numeric(resultF5[2])
if(resultF5[2] > resultF5[4]) {  KOR_pts = KOR_pts + 3 }
if(resultF5[2] < resultF5[4]) {  GER_pts = GER_pts + 3 }
if(resultF5[2] == resultF5[4]){
  KOR_pts = KOR_pts + 1
  GER_pts = GER_pts + 1
}
#6th match
resultF6  = goals(MEX, world_data$Avg_GS[mex1], world_data$Avg_GC[mex1], world_data$Pot2018[mex1], SWE, world_data$Avg_GS[swe1], world_data$Avg_GC[swe1], world_data$Pot2018[swe1])
MEX_gs    = MEX_gs + as.numeric(resultF6[2])
MEX_gc    = MEX_gc + as.numeric(resultF6[4])
SWE_gs    = SWE_gs + as.numeric(resultF6[4])
SWE_gc    = SWE_gc + as.numeric(resultF6[2])
if(resultF6[2] > resultF6[4]) {  MEX_pts = MEX_pts + 3 }
if(resultF6[2] < resultF6[4]) {  SWE_pts = SWE_pts + 3 }
if(resultF6[2] == resultF6[4]){
  MEX_pts = MEX_pts + 1
  SWE_pts = SWE_pts + 1
}

GER_di = GER_gs - GER_gc
SWE_di = SWE_gs - SWE_gc
MEX_di = MEX_gs - MEX_gc
KOR_di = KOR_gs - KOR_gc

GER_goal = c(GER_gs, GER_gc, GER_di)
SWE_goal = c(SWE_gs, SWE_gc, SWE_di)
MEX_goal = c(MEX_gs, MEX_gc, MEX_di)
KOR_goal = c(KOR_gs, KOR_gc, KOR_di)

resF   = data.frame (resultF1, resultF2, resultF3, resultF4, resultF5, resultF6)
resF
```

Set up to see the result table in group F
```{r}
#if 2 teams have the same result in everything, determine the higher team by fifa ranking updated in May 17th
teamF     = c(GER, SWE, MEX, KOR)
teamF_pts = c(GER_pts, SWE_pts, MEX_pts, KOR_pts)
teamF_gs  = c(GER_gs, SWE_gs, MEX_gs, KOR_gs)
teamF_gc  = c(GER_gc, SWE_gc, MEX_gc, KOR_gc)
teamF_di  = c(GER_di, SWE_di, MEX_di, KOR_di)
groupF   = data.frame (teamF, teamF_gs, teamF_gc, teamF_di, teamF_pts)

finalF = groupF[order(groupF$teamF_pts, decreasing = TRUE),]
rownames(finalF)[1] = "1st"
rownames(finalF)[2] = "2nd"
rownames(finalF)[3] = "3rd"
rownames(finalF)[4] = "4th"

finalF
```

These two teams qualify for the next round
```{r}
qualF1 = finalF[1,]
qualF2 = finalF[2,]
qualF1
qualF2
```

Group G:
```{r}
BEL = "Belgium"
BEL_pts = 0
PAN = "Panama"
PAN_pts = 0
TUN = "Tunisia"
TUN_pts = 0
ENG = "England"
ENG_pts = 0

for(i in 1:nrow(world_data)){
       if(world_data$Team[i] == BEL){ bel1 = i }
  else if(world_data$Team[i] == PAN){ pan1 = i }
  else if(world_data$Team[i] == TUN){ tun1 = i }
  else if(world_data$Team[i] == ENG){ eng1 = i }
}
BEL_gs = 0
BEL_gc = 0
PAN_gs = 0
PAN_gc = 0
TUN_gs = 0
TUN_gc = 0
ENG_gs = 0
ENG_gc = 0
```

```{r}
#1st match
resultG1  = goals(BEL, world_data$Avg_GS[bel1], world_data$Avg_GC[bel1], world_data$Pot2018[bel1], PAN, world_data$Avg_GS[pan1], world_data$Avg_GC[pan1], world_data$Pot2018[pan1])
BEL_gs    = BEL_gs + as.numeric(resultG1[2])
BEL_gc    = BEL_gc + as.numeric(resultG1[4])
PAN_gs    = PAN_gs + as.numeric(resultG1[4])
PAN_gc    = PAN_gc + as.numeric(resultG1[2])
if(resultG1[2] > resultG1[4]) {  BEL_pts = BEL_pts + 3 }
if(resultG1[2] < resultG1[4]) {  PAN_pts = PAN_pts + 3 }
if(resultG1[2] == resultG1[4]){
  BEL_pts = BEL_pts + 1
  PAN_pts = PAN_pts + 1
}
#2nd match
resultG2  = goals(TUN, world_data$Avg_GS[tun1], world_data$Avg_GC[tun1], world_data$Pot2018[tun1], ENG, world_data$Avg_GS[eng1], world_data$Avg_GC[eng1], world_data$Pot2018[eng1])
TUN_gs    = TUN_gs + as.numeric(resultG2[2])
TUN_gc    = TUN_gc + as.numeric(resultG2[4])
ENG_gs    = ENG_gs + as.numeric(resultG2[4])
ENG_gc    = ENG_gc + as.numeric(resultG2[2])
if(resultG2[2] > resultG2[4]) {  TUN_pts = TUN_pts + 3 }
if(resultG2[2] < resultG2[4]) {  ENG_pts = ENG_pts + 3 }
if(resultG2[2] == resultG2[4]){
  TUN_pts = TUN_pts + 1
  ENG_pts = ENG_pts + 1
}
#3rd match
resultG3  = goals(BEL, world_data$Avg_GS[bel1], world_data$Avg_GC[bel1], world_data$Pot2018[bel1], TUN, world_data$Avg_GS[tun1], world_data$Avg_GC[tun1], world_data$Pot2018[tun1])
BEL_gs    = BEL_gs + as.numeric(resultG3[2])
BEL_gc    = BEL_gc + as.numeric(resultG3[4])
TUN_gs    = TUN_gs + as.numeric(resultG3[4])
TUN_gc    = TUN_gc + as.numeric(resultG3[2])
if(resultG3[2] > resultG3[4]) {  BEL_pts = BEL_pts + 3 }
if(resultG3[2] < resultG3[4]) {  TUN_pts = TUN_pts + 3 }
if(resultG3[2] == resultG3[4]){
  BEL_pts = BEL_pts + 1
  TUN_pts = TUN_pts + 1
}
#4th match
resultG4  = goals(ENG, world_data$Avg_GS[eng1], world_data$Avg_GC[eng1], world_data$Pot2018[eng1], PAN, world_data$Avg_GS[pan1], world_data$Avg_GC[pan1], world_data$Pot2018[pan1])
ENG_gs    = ENG_gs + as.numeric(resultG4[2])
ENG_gc    = ENG_gc + as.numeric(resultG4[4])
PAN_gs    = PAN_gs + as.numeric(resultG4[4])
PAN_gc    = PAN_gc + as.numeric(resultG4[2])
if(resultG4[2] > resultG4[4]) {  ENG_pts = ENG_pts + 3 }
if(resultG4[2] < resultG4[4]) {  PAN_pts = PAN_pts + 3 }
if(resultG4[2] == resultG4[4]){
  ENG_pts = ENG_pts + 1
  PAN_pts = PAN_pts + 1
}
#5th match
resultG5  = goals(ENG, world_data$Avg_GS[eng1], world_data$Avg_GC[eng1], world_data$Pot2018[eng1], BEL, world_data$Avg_GS[bel1], world_data$Avg_GC[bel1], world_data$Pot2018[bel1])
ENG_gs    = ENG_gs + as.numeric(resultG5[2])
ENG_gc    = ENG_gc + as.numeric(resultG5[4])
BEL_gs    = BEL_gs + as.numeric(resultG5[4])
BEL_gc    = BEL_gc + as.numeric(resultG5[2])
if(resultG5[2] > resultG5[4]) {  ENG_pts = ENG_pts + 3 }
if(resultG5[2] < resultG5[4]) {  BEL_pts = BEL_pts + 3 }
if(resultG5[2] == resultG5[4]){
  ENG_pts = ENG_pts + 1
  BEL_pts = BEL_pts + 1
}
#6th match
resultG6  = goals(PAN, world_data$Avg_GS[pan1], world_data$Avg_GC[pan1], world_data$Pot2018[pan1], TUN, world_data$Avg_GS[tun1], world_data$Avg_GC[tun1], world_data$Pot2018[tun1])
PAN_gs    = PAN_gs + as.numeric(resultG6[2])
PAN_gc    = PAN_gc + as.numeric(resultG6[4])
TUN_gs    = TUN_gs + as.numeric(resultG6[4])
TUN_gc    = TUN_gc + as.numeric(resultG6[2])
if(resultG6[2] > resultG6[4]) {  PAN_pts = PAN_pts + 3 }
if(resultG6[2] < resultG6[4]) {  TUN_pts = TUN_pts + 3 }
if(resultG6[2] == resultG6[4]){
  PAN_pts = PAN_pts + 1
  TUN_pts = TUN_pts + 1
}

BEL_di = BEL_gs - BEL_gc
PAN_di = PAN_gs - PAN_gc
TUN_di = TUN_gs - TUN_gc
ENG_di = ENG_gs - ENG_gc

BEL_goal = c(BEL_gs, BEL_gc, BEL_di)
PAN_goal = c(PAN_gs, PAN_gc, PAN_di)
TUN_goal = c(TUN_gs, TUN_gc, TUN_di)
ENG_goal = c(ENG_gs, ENG_gc, ENG_di)

resG   = data.frame (resultG1, resultG2, resultG3, resultG4, resultG5, resultG6)
resG
```

Set up to see the result table in group F
```{r}
#if 2 teams have the same result in everything, determine the higher team by fifa ranking updated in May 17th
teamG     = c(BEL, PAN, TUN, ENG)
teamG_pts = c(BEL_pts, PAN_pts, TUN_pts, ENG_pts)
teamG_gs  = c(BEL_gs, PAN_gs, TUN_gs, ENG_gs)
teamG_gc  = c(BEL_gc, PAN_gc, TUN_gc, ENG_gc)
teamG_di  = c(BEL_di, PAN_di, TUN_di, ENG_di)
groupG   = data.frame (teamG, teamG_gs, teamG_gc, teamG_di, teamG_pts)

finalG = groupG[order(groupG$teamG_pts, decreasing = TRUE),]
rownames(finalF)[1] = "1st"
rownames(finalF)[2] = "2nd"
rownames(finalF)[3] = "3rd"
rownames(finalF)[4] = "4th"

finalG
```

These two teams qualify for the next round
```{r}
qualG1 = finalG[1,]
qualG2 = finalG[2,]
qualG1
qualG2
```

Group H:
```{r}
POL = "Poland"
POL_pts = 0
SEN = "Senegal"
SEN_pts = 0
COL = "Colombia"
COL_pts = 0
JPN = "Japan"
JPN_pts = 0
for(i in 1:nrow(world_data)){
       if(world_data$Team[i] == POL){ pol1 = i }
  else if(world_data$Team[i] == SEN){ sen1 = i }
  else if(world_data$Team[i] == COL){ col1 = i }
  else if(world_data$Team[i] == JPN){ jpn1 = i }
}

POL_gs = 0
POL_gc = 0
SEN_gs = 0
SEN_gc = 0
COL_gs = 0
COL_gc = 0
JPN_gs = 0
JPN_gc = 0
```

```{r}
#1st match
resultH1  = goals(COL, world_data$Avg_GS[col1], world_data$Avg_GC[col1], world_data$Pot2018[col1], JPN, world_data$Avg_GS[jpn1], world_data$Avg_GC[jpn1], world_data$Pot2018[jpn1])
COL_gs    = COL_gs + as.numeric(resultH1[2])
COL_gc    = COL_gc + as.numeric(resultH1[4])
JPN_gs    = JPN_gs + as.numeric(resultH1[4])
JPN_gc    = JPN_gc + as.numeric(resultH1[2])
if(resultH1[2] > resultH1[4]) {  COL_pts = COL_pts + 3 }
if(resultH1[2] < resultH1[4]) {  JPN_pts = JPN_pts + 3 }
if(resultH1[2] == resultH1[4]){
  COL_pts = COL_pts + 1
  JPN_pts = JPN_pts + 1
}
#2nd match
resultH2  = goals(POL, world_data$Avg_GS[pol1], world_data$Avg_GC[pol1], world_data$Pot2018[pol1], SEN, world_data$Avg_GS[sen1], world_data$Avg_GC[sen1], world_data$Pot2018[sen1])
POL_gs    = POL_gs + as.numeric(resultH2[2])
POL_gc    = POL_gc + as.numeric(resultH2[4])
SEN_gs    = SEN_gs + as.numeric(resultH2[4])
SEN_gc    = SEN_gc + as.numeric(resultH2[2])
if(resultH2[2] > resultH2[4]) {  POL_pts = POL_pts + 3 }
if(resultH2[2] < resultH2[4]) {  SEN_pts = SEN_pts + 3 }
if(resultH2[2] == resultH2[4]){
  POL_pts = POL_pts + 1
  SEN_pts = SEN_pts + 1
}
#3rd match
resultH3  = goals(JPN, world_data$Avg_GS[jpn1], world_data$Avg_GC[jpn1], world_data$Pot2018[jpn1], SEN, world_data$Avg_GS[sen1], world_data$Avg_GC[sen1], world_data$Pot2018[sen1])
JPN_gs    = JPN_gs + as.numeric(resultH3[2])
JPN_gc    = JPN_gc + as.numeric(resultH3[4])
SEN_gs    = SEN_gs + as.numeric(resultH3[4])
SEN_gc    = SEN_gc + as.numeric(resultH3[2])
if(resultH3[2] > resultH3[4]) {  JPN_pts = JPN_pts + 3 }
if(resultH3[2] < resultH3[4]) {  SEN_pts = SEN_pts + 3 }
if(resultH3[2] == resultH3[4]){
  JPN_pts = JPN_pts + 1
  SEN_pts = SEN_pts + 1
}
#4th match
resultH4  = goals(POL, world_data$Avg_GS[pol1], world_data$Avg_GC[pol1], world_data$Pot2018[pol1], COL, world_data$Avg_GS[col1], world_data$Avg_GC[col1], world_data$Pot2018[col1])
POL_gs    = POL_gs + as.numeric(resultH4[2])
POL_gc    = POL_gc + as.numeric(resultH4[4])
COL_gs    = COL_gs + as.numeric(resultH4[4])
COL_gc    = COL_gc + as.numeric(resultH4[2])
if(resultH4[2] > resultH4[4]) {  POL_pts = POL_pts + 3 }
if(resultH4[2] < resultH4[4]) {  COL_pts = COL_pts + 3 }
if(resultH4[2] == resultH4[4]){
  POL_pts = POL_pts + 1
  COL_pts = COL_pts + 1
}
#5th match
resultH5  = goals(JPN, world_data$Avg_GS[jpn1], world_data$Avg_GC[jpn1], world_data$Pot2018[jpn1],  POL, world_data$Avg_GS[pol1], world_data$Avg_GC[pol1], world_data$Pot2018[pol1])
JPN_gs    = JPN_gs + as.numeric(resultH5[2])
JPN_gc    = JPN_gc + as.numeric(resultH5[4])
POL_gs    = SEN_gs + as.numeric(resultH5[4])
POL_gc    = SEN_gc + as.numeric(resultH5[2])
if(resultH5[2] > resultH5[4]) {  JPN_pts = JPN_pts + 3 }
if(resultH5[2] < resultH5[4]) {  POL_pts = POL_pts + 3 }
if(resultH5[2] == resultH5[4]){
  JPN_pts = JPN_pts + 1
  POL_pts = POL_pts + 1
}
#6th match
resultH6  = goals(SEN, world_data$Avg_GS[sen1], world_data$Avg_GC[sen1], world_data$Pot2018[sen1], COL, world_data$Avg_GS[col1], world_data$Avg_GC[col1], world_data$Pot2018[col1])
SEN_gs    = SEN_gs + as.numeric(resultH6[2])
SEN_gc    = SEN_gc + as.numeric(resultH6[4])
COL_gs    = COL_gs + as.numeric(resultH6[4])
COL_gc    = COL_gc + as.numeric(resultH6[2])
if(resultH4[2] > resultH4[4]) {  SEN_pts = SEN_pts + 3 }
if(resultH4[2] < resultH4[4]) {  COL_pts = COL_pts + 3 }
if(resultH4[2] == resultH4[4]){
  SEN_pts = SEN_pts + 1
  COL_pts = COL_pts + 1
}

POL_di = POL_gs - POL_gc
SEN_di = SEN_gs - SEN_gc
COL_di = COL_gs - COL_gc
JPN_di = JPN_gs - JPN_gc

POL_goal = c(POL_gs, POL_gc, POL_di)
SEN_goal = c(SEN_gs, SEN_gc, SEN_di)
COL_goal = c(COL_gs, COL_gc, COL_di)
JPN_goal = c(JPN_gs, KOR_gc, JPN_di)

resF   = data.frame (resultH1, resultH2, resultH3, resultH4, resultH5, resultH6)
resF
```

Set up to see the result table in group F
```{r}
#if 2 teams have the same result in everything, determine the higher team by fifa ranking updated in May 17th
teamH     = c(POL, SEN, COL, JPN)
teamH_pts = c(POL_pts, SEN_pts, COL_pts, JPN_pts)
teamH_gs  = c(POL_gs, SEN_gs, COL_gs, JPN_gs)
teamH_gc  = c(POL_gc, SEN_gc, COL_gc, JPN_gc)
teamH_di  = c(POL_di, SEN_di, COL_di, JPN_di)
groupH   = data.frame (teamH, teamH_gs, teamH_gc, teamH_di, teamH_pts)

finalH = groupH[order(groupH$teamH_pts, decreasing = TRUE),]
rownames(finalH)[1] = "1st"
rownames(finalH)[2] = "2nd"
rownames(finalH)[3] = "3rd"
rownames(finalH)[4] = "4th"

finalH
```

These two teams qualify for the next round
```{r}
qualH1 = finalH[1,]
qualH2 = finalH[2,]
qualH1
qualH2
```

This is the knock - out phase 

```{r}
# 1C vs 2D
Match49 = data.frame(qualC1,qualD2)
# 1A vs 2B
Match50 = data.frame(qualA1,qualB2)
# 1B vs 2A
Match51 = data.frame(qualB1,qualA2)
# 1D vs 2C
Match52 = data.frame(qualD1,qualC2)
# 1E vs 2F
Match53 = data.frame(qualE1,qualF2)
# 1G vs 2H
Match54 = data.frame(qualG1,qualH2)
# 1F vs 2E
Match55 = data.frame(qualF1,qualE2)
# 1H vs 2G
Match56 = data.frame(qualH1,qualG2)
```

Reach knock-out phase This one is used to collect data.
```{r}
ko = data.frame(Match49, Match50, Match51, Match52, Match53, Match54, Match55, Match56)
write.csv(ko, file = "ko1.csv")
```

